<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymer-themes/ice.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/paper-input/paper-textarea.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">

<link rel="import" href="../bower_components/paper-checkbox/paper-checkbox.html">

<link rel="import" href="../bower_components/polymer-sortablejs/polymer-sortablejs.html">
<link rel="import" href="../bower_components/html-echo/html-echo.html">

<link rel="import" href="graph-chrome-history.html">
<link rel="import" href="graph-time-saved-daily.html">
<link rel="import" href="graph-daily-overview.html">
<link rel="import" href="graph-num-times-interventions-deployed.html">
<link rel="import" href="graph-donut-top-sites.html">


<dom-module id="popup-view">
  <style is="custom-style">
    :host {
      display: block;
      width: 100%;
      height: 100%;
      
      --paper-card: {
        
        margin-bottom: 10px;
        display: block;
        padding: 0 5px 5px 5px;
      };      
    }

    .box {
      padding: 1em;
    }

    .title {
      font-family: 'Open Sans', sans-serif;
      padding-left:0.3em;
      padding-bottom: 0.5em;
      padding-top: 0.5em;
    }

    /* Flexbox */
    .interventionContainer {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
    }

    #enabledInterventions {
      padding-top: 0.3em;
      padding-bottom: 0.3em;
      padding-left: 0.3em;
      
      font-family: 'Open Sans', sans-serif;
      margin: 0.3em;
      margin-top: 0.5em;
      font-size: 12px;
    }
    
    .interventionName {
      margin-left: 10px;
    }

    .feedbackcontents {
      margin: 5px;
    }

    .paperbuttons {
      --paper-button: {
        color: white;
        background-color: white;        
      };

      --paper-button .keyboard-focus {
        font-weight: normal;
      }
    }

  </style>

  <template>
    <div>

      <div class="box">
        <paper-card>
        <div class="interventioninfo">
          <h4 class="title">Interventions Currently Active On This Page: </h4>

          <template is="dom-repeat" items="{{enabledInterventions}}" as="intervention">
            <div class="interventionContainer" id="enabledInterventions">
              <span class="interventionName">{{intervention}}</span>
              
              <paper-menu-button vertical-offset="35">
                <paper-button class="dropdown-trigger" raised>
                  <!-- <iron-icon icon="check"></iron-icon> -->
                  <span>Disable Intervention &#x25BC;</span>
                </paper-button>
                <paper-listbox class="dropdown-content">
                  <paper-item on-click="temp_disable_button_clicked" intervention="{{intervention}}">For the Rest of the Day</paper-item>
                  <paper-item on-click="perm_disable_button_clicked" intervention="{{intervention}}">Permanently</paper-item>
                </paper-listbox>
              </paper-menu-button>            

            </div>
          </template>

        

          <template is="dom-if" if="{{isEmpty(enabledInterventions)}}">
            <div class="interventionContainer" id="enabledInterventions">
              <h4>None</h4>
            </div>
          </template>        

        </div>
        </paper-card>
        
        <paper-card style="display:none;" class="feedbackform">
        
        <div class="feedbackcontents">
            
            <paper-textarea id="feedback" cols="40" label="enter your thoughts here!" value="{{feedbackText}}"></paper-textarea>
            
            <paper-button raised on-click="submitFeedback">Submit</paper-button>
            
        </div>
        </paper-card>
        
        <paper-card>
          <div class="chartelement">
            <h4 class="title">Usage Statistics:</h4>
              <html-echo html="{{html_for_shown_graphs}}"></html-echo>

          </div>
        </paper-card>        
        
        <paper-card>
          <h4 class="title">Graphs:</h4>
          <div class="chartelement">
            <sortable-js id="graphlist_sortable" on-update="sortableupdated">
              <template is="dom-repeat" items="{{graphOptions}}" as="graph">
                <div>
                  <paper-checkbox checked="{{is_not_in_blacklist(graph, blacklist, graphNamesToOptions)}}" graph="{{graph}}" on-change="checkbox_checked_handler">{{graph}}</paper-checkbox>
                </div>
              </template>         
            </sortable-js> 
          </div> 
        </paper-card>

        <paper-button class="paperbuttons" raised id="goalsButton">Options</paper-button>
        <paper-button class="paperbuttons" raised id="resultsButton">More Statistics</paper-button>
        <paper-button class="paperbuttons" raised id="feedbackButton">Submit Feedback</paper-button>      

      </div>


    </div>
  </template>
  <script src="popup-view.js"></script>
</dom-module>
